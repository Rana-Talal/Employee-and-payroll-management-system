# ูุธุงู ุงูุฑุณุงุฆู (Inbox/Outbox System)

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุชุทุจูู ูุธุงู ุฑุณุงุฆู ูุดุงุจู ูู Gmail ูุฑุจุท ุจูู ุงูุฃูุณุงู ุงูุซูุงุซุฉ:
- **ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ (HR)**
- **ุงูุญุณุงุจุงุช (Accounting)**
- **ุงูุชุฏููู (Audit)**

---

## ููู ูุนูู ุงููุธุงูุ

### ุณููุงุฑูู ุงูุนูู ุงููุงูู:

1. **ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ุชุฑุณู ุชุฎุตูุต/ุงุณุชูุทุงุน:**
   - ููุฎุฒู ูู **ุตุงุฏุฑ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ**
   - ููุฎุฒู ูู **ูุงุฑุฏ ุงูุญุณุงุจุงุช**
   - ุงูุญุงูุฉ: `pending`

2. **ุงูุญุณุงุจุงุช ุชุฑุงุฌุน:**
   - **ุฅุฐุง ูุงููุช:**
     - ููุฎุฒู ูู **ุตุงุฏุฑ ุงูุญุณุงุจุงุช**
     - ููุฎุฒู ูู **ูุงุฑุฏ ุงูุชุฏููู**
     - ุงูุญุงูุฉ: `pending` (ุจุงูุชุธุงุฑ ููุงููุฉ ุงูุชุฏููู)

   - **ุฅุฐุง ุฑูุถุช:**
     - ููุฎุฒู ูู **ุตุงุฏุฑ ุงูุญุณุงุจุงุช**
     - ููุฎุฒู ูู **ูุงุฑุฏ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ** (ุฑุณุงูุฉ ุฑูุถ ูุน ุงูุณุจุจ)
     - ุงูุญุงูุฉ: `rejected`

3. **ุงูุชุฏููู ุชุฑุงุฌุน:**
   - **ุฅุฐุง ูุงููุช:**
     - ููุฎุฒู ูู **ุตุงุฏุฑ ุงูุชุฏููู**
     - ุฅุดุนุงุฑ ููุฌููุน ุจุงูุงุนุชูุงุฏ ุงูููุงุฆู
     - ุงูุญุงูุฉ: `approved`

   - **ุฅุฐุง ุฑูุถุช:**
     - ููุฎุฒู ูู **ุตุงุฏุฑ ุงูุชุฏููู**
     - ููุฎุฒู ูู **ูุงุฑุฏ ุงูุญุณุงุจุงุช** (ุฑุณุงูุฉ ุฑูุถ ูุน ุงูุณุจุจ)
     - ุงูุญุงูุฉ: `rejected`

---

## ุงููููุงุช ุงููููุดุฃุฉ

### 1. ุงูููููุงุช (Components)
- **`src/components/MessageInbox.jsx`** - ุตูุฏูู ุงููุงุฑุฏ (ูุดุชุฑู ุจูู ุฌููุน ุงูุฃูุณุงู)
- **`src/components/MessageOutbox.jsx`** - ุตูุฏูู ุงูุตุงุฏุฑ (ูุดุชุฑู ุจูู ุฌููุน ุงูุฃูุณุงู)

### 2. ุงูุชุญุฏูุซุงุช ุนูู ุงูุตูุญุงุช
ุชู ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุงูุฑุณุงุฆู ูู ุงูู Sidebar ููู ุตูุญุฉ:
- **`src/pages/HRDashboard.jsx`** - ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ
- **`src/pages/AccountingDashboard.jsx`** - ุงูุญุณุงุจุงุช
- **`src/pages/AuditDashboard.jsx`** - ุงูุชุฏููู

---

## ุงูููุฒุงุช ุงูููุทุจูุฉ โ

### ูู ุตูุฏูู ุงููุงุฑุฏ (Inbox):
- โ ุนุฑุถ ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ
- โ ุชุตููู ุงูุฑุณุงุฆู (ุงููู / ุบูุฑ ููุฑูุกุฉ / ููุฑูุกุฉ)
- โ ุนุฏุงุฏ ุงูุฑุณุงุฆู ุบูุฑ ุงูููุฑูุกุฉ ูุน Badge ุฃุญูุฑ
- โ ุชูููุฒ ุงูุฑุณุงุฆู ุบูุฑ ุงูููุฑูุกุฉ
- โ ุนุฑุถ ุชูุงุตูู ุงูุฑุณุงูุฉ
- โ ุฃุฒุฑุงุฑ ุงูููุงููุฉ/ุงูุฑูุถ ููุฑุณุงุฆู ุงููุนููุฉ
- โ ุนุฑุถ ุญุงูุฉ ุงูุฑุณุงูุฉ (ูุนุชูุฏ/ูุฑููุถ)

### ูู ุตูุฏูู ุงูุตุงุฏุฑ (Outbox):
- โ ุนุฑุถ ุงูุฑุณุงุฆู ุงูููุฑุณูุฉ
- โ ุชุตููู ุญุณุจ ุงูุญุงูุฉ (ุงููู / ููุฏ ุงูุงูุชุธุงุฑ / ููุจููุฉ / ูุฑููุถุฉ)
- โ Badge ูููู ุญุณุจ ุงูุญุงูุฉ
- โ ุณุฌู ุงูุฑุฏูุฏ (Timeline)
- โ ุนุฑุถ ุชูุงุตูู ุงูุฑุณุงูุฉ ูุงูุฑุฏูุฏ ุนูููุง

### ุนุงู:
- โ ุชุตููู ูุดุงุจู ูู Gmail
- โ ูุงุฌูุฉ ูุธููุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู
- โ ุฏุนู RTL ูุงูู
- โ ุฑุณูู ูุชุญุฑูุฉ ุณูุณุฉ
- โ Badge ููุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ ูู ุงูู Sidebar

---

## ูุง ูุญุชุงุฌ ุงููุทูุฑ ุนููู ูู ุงูู Backend ๐ง

### 1. ุฅูุดุงุก ุฌุฏูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

```sql
CREATE TABLE Messages (
    MessageID INT PRIMARY KEY IDENTITY(1,1),
    FromDepartment NVARCHAR(50) NOT NULL,  -- 'HR', 'Accounting', 'Audit'
    ToDepartment NVARCHAR(50) NOT NULL,    -- 'HR', 'Accounting', 'Audit'
    Subject NVARCHAR(500) NOT NULL,
    Body NVARCHAR(MAX) NOT NULL,
    Type NVARCHAR(50) NOT NULL,            -- 'entitlement', 'deduction', 'approval', 'rejection'
    Status NVARCHAR(50) NOT NULL,          -- 'pending', 'approved', 'rejected'
    IsRead BIT DEFAULT 0,
    RelatedID INT NULL,                     -- ID ุงููุชุนูู ุจุงูุชุฎุตูุต/ุงูุงุณุชูุทุงุน
    CreatedDate DATETIME DEFAULT GETDATE(),
    ReadDate DATETIME NULL
);

CREATE TABLE MessageResponses (
    ResponseID INT PRIMARY KEY IDENTITY(1,1),
    MessageID INT FOREIGN KEY REFERENCES Messages(MessageID),
    FromDepartment NVARCHAR(50) NOT NULL,
    Message NVARCHAR(MAX) NOT NULL,
    Action NVARCHAR(50) NOT NULL,          -- 'approved', 'rejected'
    ResponseDate DATETIME DEFAULT GETDATE()
);
```

### 2. ุฅูุดุงุก API Endpoints

#### a) ุฌูุจ ุงููุงุฑุฏ
```
GET /api/Messages/inbox/{department}
Response: [
  {
    "id": 1,
    "from": "ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ",
    "subject": "ุทูุจ ููุงููุฉ ุนูู ุชุฎุตูุต",
    "body": "...",
    "type": "entitlement",
    "status": "pending",
    "isRead": false,
    "createdDate": "2024-12-19T10:30:00",
    "relatedId": 123
  }
]
```

#### b) ุฌูุจ ุงูุตุงุฏุฑ
```
GET /api/Messages/outbox/{department}
Response: [
  {
    "id": 1,
    "to": "ุงูุญุณุงุจุงุช",
    "subject": "ุทูุจ ููุงููุฉ ุนูู ุชุฎุตูุต",
    "body": "...",
    "type": "entitlement",
    "status": "pending",
    "sentDate": "2024-12-19T10:30:00",
    "relatedId": 123,
    "responses": [...]
  }
]
```

#### c) ุชุญุฏูุซ ุญุงูุฉ ุงููุฑุงุกุฉ
```
PUT /api/Messages/{messageId}/read
```

#### d) ุฅุฑุณุงู ุฑุณุงูุฉ ุฌุฏูุฏุฉ
```
POST /api/Messages
Body: {
  "fromDepartment": "HR",
  "toDepartment": "Accounting",
  "subject": "ุทูุจ ููุงููุฉ",
  "body": "...",
  "type": "entitlement",
  "relatedId": 123
}
```

#### e) ุงูููุงููุฉ/ุงูุฑูุถ
```
POST /api/Messages/{messageId}/respond
Body: {
  "action": "approved" | "rejected",
  "message": "ุณุจุจ ุงูุฑูุถ ุฃู ููุงุญุธุงุช"
}
```

### 3. Logic ุงูููุงููุฉ/ุงูุฑูุถ

ุนูุฏ ุงูููุงููุฉ ุฃู ุงูุฑูุถ ูู ูุณู:
1. ุชุญุฏูุซ ุญุงูุฉ ุงูุฑุณุงูุฉ ุงูุฃุตููุฉ
2. ุฅุถุงูุฉ Response ูู ุฌุฏูู MessageResponses
3. **ุฅูุดุงุก ุฑุณุงูุฉ ุฌุฏูุฏุฉ:**
   - ุฅุฐุง ูุงููุช ุงูุญุณุงุจุงุช โ ุฅุฑุณุงู ููุชุฏููู
   - ุฅุฐุง ุฑูุถุช ุงูุญุณุงุจุงุช โ ุฅุฑุฌุงุน ููููุงุฑุฏ ุงูุจุดุฑูุฉ
   - ุฅุฐุง ุฑูุถ ุงูุชุฏููู โ ุฅุฑุฌุงุน ููุญุณุงุจุงุช
   - ุฅุฐุง ูุงูู ุงูุชุฏููู โ ุฅุดุนุงุฑ ููุงุฆู ููุฌููุน

---

## ูุซุงู ุนูู Integration

### ุนูุฏ ุฅุถุงูุฉ ุชุฎุตูุต ูู HR:

```javascript
// ูู ุตูุญุฉ ุฅุถุงูุฉ ุงูุชุฎุตูุต/ุงูุงุณุชูุทุงุน
const submitEntitlement = async (data) => {
  // 1. ุญูุธ ุงูุชุฎุตูุต
  const entitlement = await saveEntitlement(data);

  // 2. ุฅุฑุณุงู ุฑุณุงูุฉ ููุญุณุงุจุงุช
  await fetch('/api/Messages', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      fromDepartment: 'HR',
      toDepartment: 'Accounting',
      subject: `ุทูุจ ููุงููุฉ ุนูู ุชุฎุตูุต ${data.type}`,
      body: `ุชู ุฅุถุงูุฉ ุชุฎุตูุต ${data.type} ุจูุจูุบ ${data.amount} ููููุธู ${data.employeeName}`,
      type: 'entitlement',
      status: 'pending',
      relatedId: entitlement.id
    })
  });
};
```

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

### ุชุญุณููุงุช ูุณุชูุจููุฉ:
- [ ] ุฅุดุนุงุฑุงุช ููุฑูุฉ (Real-time notifications) ุจุงุณุชุฎุฏุงู SignalR
- [ ] ุฅููุงููุฉ ุฅุถุงูุฉ ูุฑููุงุช ููุฑุณุงุฆู
- [ ] ุณุฌู ูุงูู ููุชุบููุฑุงุช (Audit Trail)
- [ ] ุจุญุซ ูุชูุฏู ูู ุงูุฑุณุงุฆู
- [ ] ุฃุฑุดูุฉ ุงูุฑุณุงุฆู ุงููุฏููุฉ

---

## ููุงุญุธุงุช ูููุฉ

1. **ุงูุจูุงูุงุช ุงูุญุงููุฉ ุชุฌุฑูุจูุฉ:** ุงูุฑุณุงุฆู ุงููุนุฑูุถุฉ ุญุงููุงู ูู ุจูุงูุงุช ููููุฉ. ุจุนุฏ ุฑุจุท ุงูู APIุ ุณูุชู ุงุณุชุจุฏุงููุง ุชููุงุฆูุงู.

2. **ุนุฏุงุฏ ุงูุฑุณุงุฆู ุบูุฑ ุงูููุฑูุกุฉ:** ุญุงููุงู ูุญุฏุฏ ุจููู ุซุงุจุชุฉ:
   - ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ: 3
   - ุงูุญุณุงุจุงุช: 2
   - ุงูุชุฏููู: 1

   ูุฌุจ ุฌูุจู ูู API:
   ```javascript
   const unreadCount = await fetch('/api/Messages/unread-count/HR');
   ```

3. **ุฃุฒุฑุงุฑ ุงูููุงููุฉ/ุงูุฑูุถ:** ุญุงููุงู ุบูุฑ ูุชุตูุฉ. ูุฌุจ ุฑุจุทูุง ุจู API ุนูุฏ ุงูุชูููุฐ.

---

## ุงูุชุตููู ูุงูุฃููุงู

- **ุตูุฏูู ุงููุงุฑุฏ:** ุฃุฒุฑู (Blue)
- **ุตูุฏูู ุงูุตุงุฏุฑ:** ุฃุฎุถุฑ (Green)
- **Badge ุบูุฑ ุงูููุฑูุกุฉ:** ุฃุญูุฑ (Red)
- **ุงูุฑุณุงุฆู ุงููุนููุฉ:** ุฃุตูุฑ (Yellow)
- **ุงูุฑุณุงุฆู ุงูููุจููุฉ:** ุฃุฎุถุฑ (Green)
- **ุงูุฑุณุงุฆู ุงููุฑููุถุฉ:** ุฃุญูุฑ (Red)

---

## ุชู ุงูุชูููุฐ ุจูุงุณุทุฉ Claude Code
ุชุงุฑูุฎ: 2024-12-19
